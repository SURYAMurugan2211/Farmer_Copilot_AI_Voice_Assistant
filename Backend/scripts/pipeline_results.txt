============================================================
FARMER COPILOT - FULL PIPELINE + DB STORAGE TEST
============================================================

[TEST 1] DATABASE CONNECTION
----------------------------------------
  Tables: ['documents', 'feedback', 'queries', 'users']
  Query columns: ['id', 'user_id', 'original_text', 'translated_text', 'intent', 'confidence', 'response_text', 'audio_url', 'language', 'processing_time', 'created_at', 'input_audio_url', 'response_audio_url', 'response_text_en', 'detected_language', 'source_count', 'query_type']
  RESULT: PASS

[TEST 2] TEXT QUERY → DB STORAGE
----------------------------------------
  User: id=4, name=Test Farmer, lang=ta
  Input: நெல் பயிரில் பூச்சி கட்டுப்பாடு எப்படி?
  Translated: How to control pests in rice crop? (lang=ta)
  Saved query: id=12
    query_type=text
    detected_language=ta
    source_count=3
    response_audio_url=http://localhost:8000/audio/1d46ce35d85710f327b174eeb40d6091c59a381bf3514c6b46c18df78c990065.mp3
    response_text (first 80): நெற்பயிரில் பூச்சிகளைக் கட்டுப்படுத்த, பூச்சிகளின் எண்ணிக்கையை தொடர்ந்து கண்காணி...
    response_text_en (first 80): To control pests in rice crop, regular monitoring of the insect population is ne...
  RESULT: PASS

[TEST 3] VOICE QUERY SIMULATION → DB STORAGE
----------------------------------------
  Saved voice query: id=13
    query_type=voice
    input_audio_url=/voice_inputs/test_098f6bcd4621d373cade4e832627b4f6.wav
    response_audio_url=http://localhost:8000/audio/ccd6903ee293484389fc364436bb18bc0d1564c5fee94251d41259dc7d6e181e.mp3
    detected_language=hi
  RESULT: PASS

[TEST 4] CONVERSATION HISTORY
----------------------------------------
  History entries: 2
    [text] நெல் பயிரில் பூச்சி கட்டுப்பாடு எப்படி?...
      audio_in=None
      audio_out=http://localhost:8000/audio/1d46ce35d85710f327b174eeb40d6091...
    [voice] मेरे गेहूं में बीमारी आ गई है कैसे पहचानें?...
      audio_in=/voice_inputs/test_098f6bcd4621d373cade4e832627b4f6.wav
      audio_out=http://localhost:8000/audio/ccd6903ee293484389fc364436bb18bc...
  RESULT: PASS

[TEST 5] USER STATS
----------------------------------------
  {'total_queries': 2, 'recent_queries': 2, 'voice_queries': 1, 'text_queries': 1, 'most_common_intent': 'pest_control', 'average_processing_time': 4.35, 'languages_used': {'hi': 1, 'ta': 1}}
  RESULT: PASS

============================================================
ALL TESTS COMPLETE
============================================================
